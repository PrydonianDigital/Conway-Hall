!function(t){"use strict";function e(t){switch(t){case"ushape":t="U Shape";break;case 1:t="one";break;case 2:t="two";break;case 3:t="three";break;case 4:t="four"}return t}function i(t){var e=document.createElement("a");return e.href=t,e.pathname?(e.pathname=e.pathname.replace(/[^/]*$/,""),e.href):t}t.fn.planit=function(a){function l(e){var i=W.basepath+"/rooms/"+W.roomName+"/xml/config.xml";t.get(i,function(i){t(i).find("layout").each(function(){var e={layout:t(this).attr("title"),capacity:t(this).find("capacity").text()};P.layouts.push(e),$.push(W.basepath+"/rooms/"+W.roomName+"/floorplans/"+t(this).attr("title")+"."+t(i).find("layoutFileType").text()),void 0===V&&(V=t(this).attr("title"))}),P.settings.planTitle=t(i).find("planTitle").text(),P.settings.layoutFileType=t(i).find("layoutFileType").text(),P.settings.showVirtualTour="true"===t(i).find("showVirtualTour").text(),P.settings.showGallery="true"===t(i).find("showGallery").text(),P.settings.showOptions="true"===t(i).find("showOptions").text(),P.settings.showEnquiry="true"===t(i).find("showEnquiry").text(),"true"===t(i).find("showEnquiry").text()&&(P.settings.enquiryEmailAddress=t(i).find("enquiryEmailAddress").text()),P.settings.primaryColour=t(i).find("primaryColour").text(),P.settings.secondaryColour=t(i).find("secondaryColour").text(),P.settings.options=[],P.settings.gallery=[],P.settings.showVirtualTour&&(R+=1),P.settings.showGallery&&(R+=1),t(i).find("option").each(function(){"true"===t(this).text()&&P.settings.options.push({option:t(this).attr("title"),id:t(this).attr("id"),name:t(this).data("name")})}),t(i).find("image").each(function(){P.settings.gallery.push({title:t(this).attr("title"),filename:t(this).text()}),void 0===Q.title&&(Q.title=t(this).attr("title"))}),Q.number=1,W=t.extend(!0,{},W,P.settings),"function"==typeof e&&e()})}function o(t,e){var i,a,n=0;for(i=0,a=t.length;a>i;i++)!function(i,a){i.onload=function(){++n==t.length&&"function"==typeof e&&e()},i.src=a}(new Image,t[i])}function s(e){for(var i="",a=["jquery.printarea.min.js","jquery.fancybox.min.js","flash-detection.min.js","swfobject.min.js","jquery.mCustomScrollbar.min.js","jquery.touchSwipe.min.js","jquery.jcarousel.min.js","jquery.tooltip.min.js","tour.min.js"],n=a.length-1;n>=0;n--)i+='<script type="text/javascript" src="'+W.basepath+"/global/js/"+a[n]+'"></script>';i+='<link rel="stylesheet" type="text/css" href="'+W.basepath+'/global/lightwindow/jquery.fancybox.min.css" media="screen" />',i+='<link rel="stylesheet" type="text/css" href="'+W.basepath+'/global/css/style.min.css" media="screen" />',i+='<link rel="stylesheet" type="text/css" href="'+W.basepath+'/global/css/skin.css" media="screen"  />',i+='<link rel="stylesheet" type="text/css" href="'+W.basepath+'/global/css/jquery.mCustomScrollbar.min.css" media="screen"  />',i+='<link rel="stylesheet" type="text/css" href="'+W.basepath+'/global/css/print.min.css" media="print" />',t("head").append(i),"function"==typeof e&&e()}function r(){t(".fancybox").fancybox({scrolling:"no"})}function c(){t("#mycarousel").jcarousel({auto:!0,vertical:!0,scroll:1,wrap:"last",itemFallbackDimension:105}),t(".jcarousel-container-vertical").outerHeight(t("#planit").height()-80)}function u(){t("#gallery_display").swipe({swipe:function(t,e,i,a,n,l){M(t,e,i,a,n,l)},threshold:0})}function d(){t(".jcarousel-container-vertical").mCustomScrollbar({scrollButtons:{enable:!1},scrollbarPosition:"outside"})}function p(e){U.append(t("<div>").attr("id","planit_container").append(f(),h(),m()),g());var i=window.setInterval(function(){var a=document.getElementById("marker");a&&(window.clearInterval(i),t(a).remove(),t("#preloader").hide(),v(),"function"==typeof e&&e())},100)}function h(){var i,a=t("<ul>").attr("id","capacities");t.each(P.layouts,function(n,l){i=t('<li data-current-layout="'+l.layout+'">'+e(l.layout)+"<span>"+l.capacity+"</span></li>"),l.layout==V&&i.addClass("selected"),a.append(i)});var n='<div id="planit_left"><div class="planit_left_col capacities round"><div class="title round">Layouts & Capacities</div>'+a.prop("outerHTML")+"</div>";if(W.showOptions){n+='<div class="planit_left_col options round"><div class="title round">Options</div><ul>';var l;t.each(W.options,function(t,e){void 0===l&&(l=t),l%2===0&&(n+=" <li>"),n+='<a id="'+e.id+'" href="#" data-alt="'+e.id+'_mob"><div><i class="icon-'+e.id+'"></i></div><span>'+e.name+"</span></a>",l+=1,l%2===0&&(n+=" </li>")}),W.showEnquiry===!0&&(n+='<li><a class="enquire" style="background:'+W.secondaryColour+'" href="mailto:'+W.enquiryEmailAddress+'"><span>Enquire about this room</span></a></li>'),n+="</ul></div>"}return n+="</div>"}function m(){var i,a,n=t("<select>").attr("id","layouts-select");t.each(P.layouts,function(l,o){a=t('<option value="'+o.layout+'" data-capacity="'+o.capacity+'">'+e(o.layout)+"</option>"),n.append(a),0===l&&(i=o.capacity)});var l='<div id="top-bar-mobile"><div id="floorplan_title_mobile">'+W.planTitle+'</div><div id="mobile_room_select"><div><div>Room Layout Style</div><div class="left">Capacity</div></div><div><div>'+n.prop("outerHTML")+'</div><div><span class="capacity">'+i+'</span></div></div></div><div id="mobile_gallery"><div><div>Gallery</div></div><div><div id="current-image-title">'+W.gallery[0].title+'</div><div><span class="current-image">1</span> of '+W.gallery.length+'</div></div></div><div id="mobile_virtual_tour"><div>Virtual Tour</div></div></div>',o='<div id="planit_right"><div id="main_content_panel"><div id="preloader"><div></div></div>'+l+'<div id="plan_info"><a href="#" id="menu_toggle" class="active"><span></span></a><div id="floorplan_title">'+W.planTitle+'</div></div><div id="gallery_display"></div><div id="panaround_virtual_tour"><div id="html5_tour"></div></div><div id="planit_floorplan_display"><img id="image_floorplan_base" src="'+W.basepath+"/rooms/"+W.roomName+'/floorplans/base.jpg" /><img id="current_layer" src="'+W.basepath+"/rooms/"+W.roomName+"/floorplans/"+V+"."+W.layoutFileType+'" /><div id="marker"></div>';if(t.each(W.options,function(t,e){o+='<img id="image_'+e.id+'" src ="'+W.basepath+"/rooms/"+W.roomName+"/floorplans/"+e.id+'.svg" />'}),o+='</div><div id="swipe-message"><img src="'+W.basepath+'/global/img/swipe.svg">Swipe left & right to view</div><div id="planit_right_footer" class="'+e(R)+'">',W.showOptions){o+='<div id="mobile_options">',W.options.length>0&&(o+='<div class="header">Options</div>');var s;t.each(W.options,function(t,i){void 0===s&&(s=t),o+='<a id="'+i.id+'_mob" href="#" class="button options mob '+e(W.options.length)+'" data-alt="'+i.id+'"><span><i class="icon-'+i.id+'"></i></span>'+i.name+"</a>"}),o+="</div>"}return W.showVirtualTour===!0&&(o+='<a class="button context_switch" style="background:'+W.secondaryColour+'" data-context="tour" id="tour_button"><span><i class="icon-tour"></i></span>Virtual Tour</a>'),o+='<a class="button context_switch" style="background:'+W.secondaryColour+'" data-context="plan" id="plan_button"><span><i class="icon-plan"></i></span>Floor Plan</a>',W.showGallery===!0&&(o+='<a class="button context_switch" style="background:'+W.secondaryColour+'" data-context="gallery" id="gallery_button"><span><i class="icon-gallery"></i></span>Gallery</a>'),o+='<a class="fancybox button" style="background:'+W.secondaryColour+'" id="enlarge_button" href="#lightbox" onclick="javascript:setTimeout(function(){$(window).resize();},250)"><span><i class="icon-enlarge"></i></span>Enlarge</a>',W.showEnquiry===!0&&(o+='<a class="enquire button" style="background:'+W.secondaryColour+'" href="mailto:'+W.enquiryEmailAddress+'">Enquire about this room</a>'),o+='<a href="http://www.panaround.co.uk" target="_blank"><img id="logo" src="'+W.basepath+'/global/img/planit-logo.png" alt=""/></a></div></div></div>'}function g(){var e='<div id="lightbox" style="position:relative;height:'+B+';"><img id="lightbox_main_image" src="'+W.basepath+"/rooms/"+W.roomName+'/floorplans/base.jpg" style="width: 100%; position: relative" /><img id="lightbox_current_layer" src="'+W.basepath+"/rooms/"+W.roomName+"/floorplans/"+V+"."+W.layoutFileType+'" style="position:absolute; left:0; top: 0; z-index:2;" />';return t.each(W.options,function(t,i){e+='<img id="lightbox_'+i.id+'" src ="'+W.basepath+"/rooms/"+W.roomName+"/floorplans/"+i.id+"."+W.layoutFileType+'" style="position:absolute; display:none; left:0; top: 0; z-index:3;" />'}),e+='<a href="#" class="print" rel="lightbox" style="background:'+W.secondaryColour+'">Print</a></div>'}function f(){var e='<div id="planit_left_gallery" class="hide"><div class="planit_left_col_gallery gallery round"><div class="title round">Gallery</div>';return e+='<div id="secondary_title"><span>'+Q.title+'</span><div id="current_gallery_image"><span class="current-image">1</span> of '+W.gallery.length+'</div></div><ul id="mycarousel" class="jcarousel jcarousel-skin">',t.each(W.gallery,function(t,i){t%2===0&&(e+=" <li>"),e+='<a href="'+W.basepath+"/rooms/"+W.roomName+"/gallery/main/"+i.filename+'" data-current-gallery-image="'+(t+1)+'"><img title="'+i.title+'" class="left" src="'+W.basepath+"/rooms/"+W.roomName+"/gallery/thumbs/"+i.filename+'" width="70" height="70" style="'+(0===t?"opacity:0.5":"")+'" alt="" /></a>',t%2!==0&&(e+=" </li>")}),e+="</ul></div>",W.showEnquiry===!0&&(e+='<ul id="gallery_enquire"><li><a class="enquire" style="'+W.secondaryColour+'" href="mailto:'+W.enquiryEmailAddress+'"><span>Enquire about this room</span></a></li></ul>'),e+="</div>"}function y(e){var i=W.basepath+"/rooms/"+W.roomName+"/floorplans/"+e+"."+W.layoutFileType;if(t("#current_layer").attr("src")!==i){var a=navigator.userAgent;if(a.match("Safari")&&a.match("OS X")){var n='<img id="current_layer" src="'+i+'" style="width: '+t("#image_floorplan_base").width()+"px; height: "+t("#image_floorplan_base").height()+"px; left: "+t("#image_floorplan_base").css("left")+"; top: "+t("#image_floorplan_base").css("top")+';" />';t("#current_layer").remove(),t(n).insertAfter(t("#image_floorplan_base"))}else t("#current_layer").attr("src",i);t("#lightbox_current_layer").attr("src",i)}}function _(t,e,i,a){var n=Math.min(i/t,a/e);return{width:t*n,height:e*n}}function v(){var e=t("#planit_container #planit_floorplan_display"),i=t("#planit_container img#image_floorplan_base, #current_layer, img#image_screens, img#image_dimensions, img#image_power, img#image_fire"),a=t("#lightbox_main_image, #lightbox_current_layer, #lightbox_screens, #lightbox_power, #lightbox_fire, #lightbox_dimensions, .fancybox-skin"),n=t("#image_floorplan_base").height(),l=e.height()-50,o=t("#image_floorplan_base").width(),s=e.width(),r=X?140:t("#planit_container #floorplan_title").height()+parseInt(t("#planit_container #floorplan_title").css("top"));l=l-t("#planit_right_footer").height()-r;var c=_(o,n,s-40,l);b(c,i,s,l,0,r);var u=t("#lightbox").width();t("#lightbox").css("height",t("#lightbox_main_image").height()+"px"),a.width(u+"px")}function b(t,e,i,a,n,l,o){if(t.height>10&&t.width>10){e.css("width",t.width),e.css("height",t.height);var s=(i-t.width)/2;e.css("left",s+n);var r=(a-t.height)/2;e.css("top",r+l)}"function"==typeof o&&o()}function w(e,i){"plan"==e&&t("#planit_left").addClass("hide"),"gallery"==e&&t("#planit_left_gallery").addClass("hide"),"tour"==L&&t("#planit_right").addClass("full"),X?"function"==typeof i&&i():setTimeout(function(){"function"==typeof i&&i()},1e3)}function x(e,i){"plan"==e&&t("#planit_left").removeClass("hide"),"gallery"==e&&t("#planit_left_gallery").removeClass("hide"),t("#planit_right").removeClass("full"),X?"function"==typeof i&&i():setTimeout(function(){"function"==typeof i&&i()},1e3)}function C(e){t("#planit_floorplan_display").animate({opacity:0},450),t("#enlarge_button").hide(),t("#lightwindow").hide(),t("#plan_button").show(),t("#mobile_room_select").hide(),t("#mobile_options").hide(),w("plan",function(){t("#image_floorplan_base").hide(),t("#planit_floorplan_display").hide(),"function"==typeof e&&e()})}function k(){t("#enlarge_button").show(),t("#mobile_room_select").show(),X&&t("#mobile_options").show(),t("#plan_button").hide(),t("#planit_right_footer").addClass(e(R)),"tour"==z&&E(function(){j()}),"gallery"==z&&A(function(){j()})}function j(){t("#panaround_virtual_tour").hide(),t("#planit_floorplan_display").show(),x("plan",function(){t("#planit_floorplan_display").animate({opacity:1},450),t("#image_floorplan_base").show(),t("#lightwindow").show(),v()})}function T(){t("#tour_button").hide(),t("#html5_tour").hide(),t("#planit_right_footer").addClass(e(R-1)),t("#mobile_virtual_tour").show(),"gallery"==z&&A(function(){q()}),"plan"==z&&C(function(){q()})}function q(){t("#panaround_virtual_tour").css({opacity:1}),t("#panaround_virtual_tour").fadeIn(function(){setTimeout(function(){t("#html5_tour").css("width","100%"),t("#html5_tour").css("height","100%"),embedpano({swf:W.basepath+"/global/js/tour.swf",xml:W.basepath+"/rooms/"+W.roomName+"/tour/tour.xml",target:"html5_tour",html5:"auto",passQueryParameters:!0}),setTimeout(function(){t("#html5_tour").fadeIn(300)},200)},200)})}function E(e){t("#panaround_virtual_tour").css({opacity:0}),t("#html5_tour").html("").hide(),t("#mobile_virtual_tour").hide(),t("#tour_button").show(),"function"==typeof e&&e()}function N(){t("#gallery_button").hide(),t("#mobile_gallery").show(),t("#planit_right_footer").addClass(e(R-1)),X&&G(),"tour"==z&&E(function(){I()}),"plan"==z&&C(function(){I()})}function I(){t("#panaround_virtual_tour").hide(),t("#gallery_display").show().animate({opacity:1},450),t("#planit_left_gallery").show(),x("gallery",function(){X?setTimeout(function(){O(W.basepath+"/rooms/"+W.roomName+"/gallery/main/image-1.jpg")},450):O(W.basepath+"/rooms/"+W.roomName+"/gallery/main/image-1.jpg")})}function A(e){t("#gallery_button").show(),t("#mobile_gallery").hide(),t("#gallery_display img").fadeOut(),t("#gallery_display").animate({opacity:0},450),w("gallery",function(){t(this).hide(),t("#gallery_display").hide(),t("#single_image").hide(),"function"==typeof e&&e()})}function O(e){var i=t("#gallery_display img"),a=t("<img />");a.attr("src",e),a.unbind("load"),a.bind("load",function(){F(this,a,function(){i.stop(!0).fadeOut(100,function(){t(this).remove()}),a.fadeIn(400)})})}function F(e,i,a){var n,l=t("#main_content_panel").width()-100,o=t("#main_content_panel").height()-100-t("#planit_right_footer").height();X&&(o-=104),null!==e?(n=_(e.width,e.height,l,o),i.hide(),t("#gallery_display").append(i)):n=_(i.width(),i.height(),l,o);var s=X?150:65;b(n,i,l,o,50,s,function(){"function"==typeof a&&a()})}function S(e){var i=e.userAgentDetection?e.userAgentIsMobile:window.innerWidth<e.mobileBreakpoint;return i&&!t("#planit").hasClass("mobile")?(t("#planit").addClass("mobile"),"plan"==L&&setTimeout(function(){"plan"==L&&t("#planit.mobile #mobile_options").slideDown()},1e3),D(function(){D()})):!i&&t("#planit").hasClass("mobile")&&(t("#planit").removeClass("mobile"),t("#planit #mobile_options").hide(),t("#planit_right_footer").removeClass("absolute"),D()),i}function D(e){var i=setInterval(function(){v(),F(null,t("#gallery_display img"))},10);setTimeout(function(){clearInterval(i),X?t("#planit_right_footer").addClass("absolute"):t("#planit_right_footer").removeClass("absolute"),"function"==typeof e&&e()},1e3)}function G(){setTimeout(function(){t("#swipe-message").fadeIn(function(){setTimeout(function(){t("#swipe-message").fadeOut()},1500)})},500)}function M(e,i){if(X){var a=parseInt(t("span.current-image").html())-1;if("left"==i&&W.gallery.length>a+1){var n=W.gallery[a+1];Q.title=n.title,t("#secondary_title > span").html(Q.title),O(W.basepath+"/rooms/"+W.roomName+"/gallery/main/"+n.filename),t("span.current-image").html(a+2),t("#current-image-title").html(n.title)}if("right"==i&&a-1>=0){var l=W.gallery[a-1];Q.title=l.title,t("#secondary_title > span").html(Q.title),O(W.basepath+"/rooms/"+W.roomName+"/gallery/main/"+l.filename),t("span.current-image").html(a),t("#current-image-title").html(l.title)}}}var B,V,H={basepath:i(n)+"../..",roomName:"room-name",userAgentDetection:!1,userAgentIsMobile:!1,mobileBreakpoint:750},L="plan",z="plan",P={layouts:[],settings:{},gallery:[]},$=[],Q={},R=1,U=t(this),W=t.extend(!0,{},H,a),X=S(W);t(function(){l(function(){o($,function(){s(function(){r(),p(function(){c(),u(),d(),S(W),t("#planit").width()>=500&&(t("#planit").removeClass("menu_hidden"),t("#menu_toggle").removeClass("active"),D())})})})})}),t(window).resize(function(){X=S(W),"plan"==L&&v(),"gallery"==L&&(F(null,t("#gallery_display img")),t(".jcarousel-container-vertical").outerHeight(t("#planit").height()-80)),t("#planit").width()<500?t("#planit").hasClass("menu_hidden")||(t("#menu_toggle").fadeOut(function(){t(this).addClass("active")}),t("#planit").addClass("menu_hidden"),D()):t("#menu_toggle").is(":hidden")&&(t("#menu_toggle").fadeIn(),t("#planit").removeClass("menu_hidden"),D())}),t("ul#capacities li").live({mouseenter:function(){y(t(this).data("current-layout"))},mouseleave:function(){y(V)},click:function(e){e.preventDefault(),t("ul#capacities li").removeClass("selected"),V=t(this).data("current-layout"),y(V),t(this).addClass("selected"),t("a#single_image").attr("href",W.basepath+"/rooms/"+W.roomName+"/floorplans/"+V+"."+W.layoutFileType)}}),t('select[id="layouts-select"]').live("change",function(){y(t(this).val()),t("span.capacity").html(t(this).find(":selected").data("capacity"))}),t("#planit_container .options ul li a, #mobile_options a").live("click",function(e){e.preventDefault();var i=t(this).hasClass("mob")?t(this).data("alt"):t(this).attr("id"),a=t("#image_"+i),n=t("#lightbox_"+i);a.toggle(),n.toggle(),t(this).toggleClass("selected"),t("#"+t(this).data("alt")).toggleClass("selected")}),t("#planit_container .options ul li a").live({mouseenter:function(){t(this).addClass("hovered")},mouseleave:function(){t(this).removeClass("hovered")}}),t(".context_switch").live("click",function(){switch(z=L,L=t(this).data("context"),t("#planit_right_footer").removeClass("one two three"),L){case"plan":k();break;case"tour":T();break;case"gallery":N()}}),t("#mycarousel a").live({mouseenter:function(){t("#secondary_title > span").html(t(this).find("img").attr("title")),t("#current_gallery_image .current-image").html(t(this).data("current-gallery-image"))},mouseleave:function(){t("#secondary_title > span").html(Q.title),t("#current_gallery_image .current-image").html(Q.number)},click:function(e){e.preventDefault(),Q.title=t(this).find("img").attr("title"),Q.number=t(this).data("current-gallery-image"),t("#secondary_title > span").html(Q.title),t("#current_gallery_image .current-image").html(t(this).data("current-gallery-image")),O(this.href),t("#mycarousel img").css({opacity:1}),t(this).find("img").css({opacity:.5})}}),t("#menu_toggle").live("click",function(e){e.preventDefault(),t(this).toggleClass("active"),t("#planit").toggleClass("menu_hidden"),D()})};var a=document.getElementsByTagName("script"),n=a[a.length-1].src;t(function(){t(".print").live("click",function(){var e=t(this).attr("rel"),i=navigator.userAgent;if(!/MSIE (\d+\.\d+);/.test(i)&&!/rv:11.0/i.test(i))return t("#"+e).printArea(),!1;var a=document.getElementById(e),n=window.open();n.document.write(a.innerHTML),n.document.close(),n.focus(),n.print(),n.close()})}),t.fn.extend({live:function(e,i,a){return t(this.context).on(e,this.selector,i,a),this}})}($);